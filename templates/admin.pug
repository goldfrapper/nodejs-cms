doctype html
html
  head
    title NodeJS-CMS Admin
    include head.pug
  body
    div(class="container")
      div(class="header")
        h1
          img(src="/resources/favicon.png" height="32px" width="32px") 
          b(class="text-capitalize")=page.title
          small(class="text-muted")  NodeJS-CMS

      nav(class="navbar navbar-expand-lg")
        div(class="container-fluid")
          //- a(class="navbar-brand" href="/admin") Admin
          div(class="collapse navbar-collapse")
            ul(class="navbar-nav")
              each title in admin.nav
                - var _class = 'nav-link';
                - _class += (page.title==title)? ' active' : '';
                - link = '/admin/'+title
                li(class="nav-item")
                  a(class=_class href=link)=title
          span(class="navbar-text")
            a(href='/' target='_blank') Visit the website


      mixin settings-form()
        form(method=form.method action=form.action)
          each s in settings
            div(class="mb-3")
              - h = s.key+'Help';
              label(for=s.key class="form-label")=s.name
              input(type="text" class="form-control" 
                name=s.key
                value=s.value id=s.key aria-describedby=h)
              div(id=h class="form-text")=s.note

          div(class="mb-3")
            button(type="submit" class="btn btn-primary") Submit
            
      mixin article-form()
        form(method="POST" action="/admin/content")
          
          mixin form_input(input)
            input(type=input.type class="form-control" 
              name=input.name
              value=input.value id=input.id
              aria-describedby=input.helpId)
          mixin form_hidden(input)
            input(type='hidden' name=input.name value=input.value)
          mixin form_textarea(input)
            br
            textarea(
              name=input.name
              id=input.id
              aria-describedby=input.helpId
            )=input.value
          mixin form_select(input)
            select
              option Draft
              option Published
          
          each input in form.list()
            
            if input.type == 'textarea'
              label(for=input.id class="form-label")=input.label
              +form_textarea(input)
            else if input.type == 'hidden'
              +form_input(input)
            else if input.type == 'select'
              label(for=input.id class="form-label")=input.label
              +form_select(input)
              div(id=input.helpId class="form-text")=input.helpText
            else
              label(for=input.id class="form-label")=input.label
              +form_input(input)
              div(id=input.helpId class="form-text")=input.helpText
          
          div(class="mb-3")
            br
            button(type="submit" class="btn btn-primary") Submit
      
      mixin content-list()
        ul
          each c in contentlist
            li
              - link = "/admin/content?ref=" + c.ref;
              a(href=link)=c.title

      block maincontent
      
      div(class="row align-items-start justify-content-start")
        if page.title == 'settings'
          +settings-form()
      
        if page.title == 'content'
          div(class="col-2")
            +content-list()
          div(class="col-10")
            if content
              +article-form()
      
        

      include footer.pug
